#!/usr/bin/env bash

##############################################
#   Author: Roy Conn
#   Project: appmgr
#   Version: 1.0
#
#   Usage:
#
#   Description:
#		Appmenu, App switcher, etc.
##############################################

# shellcheck disable=SC1091
source "${SCRIPTS:=$HOME/.local/bin}"/00-api.sh

# Preprocessor flags
DISABLE_ROOT
REQUIRE_CMD "rofi" || exit 1

####################################

_menu() {
	rofi -show drun -scroll-method 1 -show-icons -columns 2 -disable-history -sorting-method 'fzf'
}

_switcher() {
	rofi -show window -window-icon -window-format "{c}    {t}"
}

_help () {
	_flags () {
		PRINT "-------------|------|---------------------"
		PRINT "Flag|Args|Description"
		PRINT "-------------|------|---------------------"
		PRINT "||"
		PRINT "--menu|n/a|Application Menu"
		PRINT "--switcher|n/a|Switch between running apps"
		PRINT "||"
		PRINT "-h, --help|n/a|Show this prompt"
	}

	PRINT "$(SCRIPTNAME) - Invoke common app management programs"
	PRINT
	PRINT "Usage:\t\t$(SCRIPTNAME) <flag> <args?>"
	PRINT "Example:\t$(SCRIPTNAME) --menu"
	PRINT
	_flags | column -t -s'|'
}


# If no arguments are give, just show help prompt.
[[ $# -eq 0 ]] && _help && exit 0

# Iterate over all arguments and evaluate them
while test $# -gt 0; do

	case "$(LOWERCASE ${1})" in

		-m | --menu ) shift; _menu; exit $? ;;

		-s | --switcher ) shift; _switcher; exit $? ;;

		\? | -h | --help ) shift; _help; exit 0 ;;

		* ) PRINT "$(SCRIPTNAME): Invalid argument '${1}'" && exit 1 ;;

	esac

done

